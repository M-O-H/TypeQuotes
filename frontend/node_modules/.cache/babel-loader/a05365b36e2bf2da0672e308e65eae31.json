{"ast":null,"code":"import _regeneratorRuntime from\"/home/m-o-h/programs/Lap/typing-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/m-o-h/programs/Lap/typing-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/m-o-h/programs/Lap/typing-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/home/m-o-h/programs/Lap/typing-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{useState,useEffect}from'react';import{getResult,replace}from'./keyPress';import styled from'styled-components';import Status from'./Status';import Spinner from'react-bootstrap/Spinner';import axios from'axios';import'../style/style.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var correctLetters=0;var startTime=null;var mistakes=0;var index=0;var string=0;var BoxWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\ndisplay: flex;\\npadding: 0 6em;\\njustify-content: center;\\nalign-items: center;\\nheight: 60vh;\\nwidth: 100%;\\n\"])));var SpinnerWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\ndisplay: flex;\\njustify-content: center;\\nalign-items: center;\\nwidth: 100%;\\nheight: 100%;\"])));var Button=styled.button(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\nborder: none;\\noutline: none;\\npadding: 1rem;\\nbackground: var(--icons-text-color);\\ncolor: var(--body-background);\\n\"])));var handleKeyPress=function handleKeyPress(e,text){var arrayQuote=document.querySelectorAll('span');var cursorCharacter=arrayQuote[index];arrayQuote[0].style.backgroundColor='initial';if(!startTime)startTime=new Date();if(e.keyCode===8&&index>0){--correctLetters;--string;cursorCharacter.classList.remove('cursor');cursorCharacter=arrayQuote[--index];cursorCharacter.classList.remove('incorrect','done');}else if(string>=93){console.log(\"inc\");}else if(e.key===cursorCharacter.innerText){++correctLetters;string=0;replace(cursorCharacter,['done','incorrect','cursor']);cursorCharacter=arrayQuote[++index];}else if(e.key!==cursorCharacter.innerText){++mistakes;++string;replace(cursorCharacter,['incorrect','done','cursor']);cursorCharacter=arrayQuote[++index];}if(index>=text.length){var result=getResult(arrayQuote,text,startTime,correctLetters,mistakes);return result;}cursorCharacter.classList.add('cursor');};var Input=function Input(){var _useState=useState(function(){return'';}),_useState2=_slicedToArray(_useState,2),quote=_useState2[0],setQuote=_useState2[1];var _useState3=useState(function(){return true;}),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(function(){return null;}),_useState6=_slicedToArray(_useState5,2),result=_useState6[0],setResult=_useState6[1];index=0;correctLetters=0;startTime=null;mistakes=0;index=0;var KeyDownEvent=function KeyDownEvent(){document.onkeydown=function(e){var value=handleKeyPress(e,quote);if(value){var result;axios(\"/user\").then(function(res){result={id:res.data.id,wpm:value.wpm,acc:value.accuracy};setResult(result);document.onkeydown=null;}).then(function(err){if(err){result={wpm:value.wpm,acc:value.accuracy};setResult(result);}});}};};var fetchQuotes=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);setResult(null);_context.next=4;return axios.get('https://api.quotable.io/random').then(function(res){setLoading(false);setQuote(res.data.content);}).catch(function(err){throw err;});case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchQuotes(){return _ref.apply(this,arguments);};}();var handleClick=function handleClick(e){e.target.blur();fetchQuotes();};if(!loading)KeyDownEvent();useEffect(function(){setResult(null);fetchQuotes();},[]);var render=function render(){if(loading===true)return/*#__PURE__*/_jsx(SpinnerWrapper,{className:\"SpinnerWrapper\",children:/*#__PURE__*/_jsx(Spinner,{className:\"spinner\",animation:\"border\"})});else if(result==null){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"display-quote\",children:quote.split('').map(function(char,id){return/*#__PURE__*/_jsx(\"span\",{className:\"char\",children:char.toLowerCase()},id);})}),/*#__PURE__*/_jsx(Button,{type:\"submit\",tabindex:\"-1\",onClick:handleClick,className:\"disabled\",children:\"NEXT\"})]});}else return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Status,{result:result}),/*#__PURE__*/_jsx(Button,{type:\"submit\",tabindex:\"-1\",onClick:handleClick,className:\"disabled\",children:\"Next\"})]});};return/*#__PURE__*/_jsx(BoxWrapper,{children:render()});};export default Input;","map":{"version":3,"sources":["/home/m-o-h/programs/Lap/typing-game/frontend/src/components/Input.js"],"names":["React","useState","useEffect","getResult","replace","styled","Status","Spinner","axios","correctLetters","startTime","mistakes","index","string","BoxWrapper","div","SpinnerWrapper","Button","button","handleKeyPress","e","text","arrayQuote","document","querySelectorAll","cursorCharacter","style","backgroundColor","Date","keyCode","classList","remove","console","log","key","innerText","length","result","add","Input","quote","setQuote","loading","setLoading","setResult","KeyDownEvent","onkeydown","value","then","res","id","data","wpm","acc","accuracy","err","fetchQuotes","get","content","catch","handleClick","target","blur","render","split","map","char","toLowerCase"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { getResult ,replace } from './keyPress';\nimport styled  from 'styled-components'\nimport Status from './Status';\nimport Spinner from 'react-bootstrap/Spinner'\nimport axios from 'axios';\nimport '../style/style.css'\n\nvar correctLetters = 0;\nvar startTime = null;\nvar mistakes = 0;\nvar  index = 0;\nvar string = 0;\n\nconst BoxWrapper = styled.div`\ndisplay: flex;\npadding: 0 6em;\njustify-content: center;\nalign-items: center;\nheight: 60vh;\nwidth: 100%;\n`;\n\nconst SpinnerWrapper = styled.div`\ndisplay: flex;\njustify-content: center;\nalign-items: center;\nwidth: 100%;\nheight: 100%;`\n\nconst Button = styled.button`\nborder: none;\noutline: none;\npadding: 1rem;\nbackground: var(--icons-text-color);\ncolor: var(--body-background);\n`\nconst handleKeyPress = (e, text)=>{\n\tconst arrayQuote = document.querySelectorAll('span');\n\tlet cursorCharacter =  arrayQuote[index];\n\tarrayQuote[0].style.backgroundColor = 'initial';\n\tif(!startTime)\n\t\tstartTime = new Date();\n\tif(e.keyCode === 8 && index > 0){\n\t\t--correctLetters;\n\t\t--string;\n\t\tcursorCharacter.classList.remove('cursor');\n\t\tcursorCharacter =  arrayQuote[--index];\n\t\tcursorCharacter.classList.remove('incorrect', 'done');\n\t}\n\telse if(string >= 93){\n\t\tconsole.log(\"inc\")\n\t}\n\telse if(e.key === cursorCharacter.innerText ){\n\t\t++correctLetters;\n\t\tstring = 0;\n\t\treplace(cursorCharacter, ['done', 'incorrect', 'cursor']);\n\t\tcursorCharacter =  arrayQuote[++index];\n\t}\n\telse if(e.key !== cursorCharacter.innerText){\n\t\t++mistakes;\n\t\t++string;\n\t\treplace(cursorCharacter, ['incorrect', 'done', 'cursor']);\n\t\tcursorCharacter =  arrayQuote[++index];\n\t}\n\tif(index  >= text.length){\n\t\tvar result = getResult(arrayQuote,text, startTime, correctLetters, mistakes);\n\t\treturn result\n\t}\t\n\tcursorCharacter.classList.add('cursor');\n};\n\n\nconst Input = ()=>{\n\tconst [quote, setQuote] = useState(()=>'');\n\tconst [loading, setLoading] = useState(()=>true);\n\tconst [result, setResult] = useState(()=>null);\n\n\tindex = 0;\n\tcorrectLetters = 0;\n\tstartTime = null;\n\tmistakes = 0;\n\tindex = 0;\n\t\n\n\tconst KeyDownEvent = () => {\n\t\tdocument.onkeydown =((e)=>{\n\t\t\tlet value =  handleKeyPress(e, quote);\n\t\t\tif(value){\n\t\t\t\tvar result;\n\t\t\t\taxios(\"/user\")\n\t\t\t\t.then(res => {\n\t\t\t\t\tresult = {id:res.data.id, wpm:value.wpm, acc:value.accuracy}\n\t\t\t\t\tsetResult(result);\n\t\t\t\t\tdocument.onkeydown = null;\n\t\t\t\t})\n\t\t\t\t.then(err => {\n\t\t\t\t\tif(err){\n\t\t\t\t\tresult = {wpm:value.wpm, acc:value.accuracy}\n\t\t\t\t\tsetResult(result)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n\n\tconst fetchQuotes = async()=>{\n\t\tsetLoading(true)\n\t\tsetResult(null);\n\t\tawait axios.get('https://api.quotable.io/random')\n\t\t.then(res => {\n\t\t\tsetLoading(false)\n\t\t\tsetQuote(res.data.content);\n\t\t})\n\t\t.catch((err) => {\n\t\t\tthrow err;\n\t\t})\n\t}\n\t\n\tconst handleClick = (e) => {\n\t\te.target.blur();\n\t\tfetchQuotes()\n\t}\n\t\n\n\tif(!loading)\n\t\tKeyDownEvent()\n\nuseEffect(() => {\n\tsetResult(null);\n\tfetchQuotes();\n}, []);\n\n\nconst render = ()=>{\n\tif(loading === true)\n\t\treturn <SpinnerWrapper className=\"SpinnerWrapper\"><Spinner className=\"spinner\" animation=\"border\" /></SpinnerWrapper>\n\telse if(result == null){\n\t\treturn <div>\n\t\t<div className=\"display-quote\">{\n\t\t\t\tquote.split('').map((char, id) => <span key={id} className=\"char\">{char.toLowerCase()}</span>)}\n\t\t\t</div>\n\t\t\t<Button type=\"submit\" tabindex=\"-1\" onClick={handleClick} className=\"disabled\" >NEXT</Button>\n\t\t</div>\n\t\t}\n\t\telse return <div>\n\t\t\t<Status result={result}/>\n\t\t\t<Button type=\"submit\" tabindex=\"-1\" onClick={handleClick} className=\"disabled\" >Next</Button>\n\t\t</div>\n}\n\treturn (\n\t\t<BoxWrapper> \n\t\t\t{render()}\n\t\t</BoxWrapper>\n\t)\n}\n\nexport default Input"]},"metadata":{},"sourceType":"module"}